<div class="space-y-6">
    <!-- Page header -->
    <div>
        <h1 class="text-2xl font-bold text-gray-900 dark:text-white">Settings</h1>
        <p class="text-gray-600 dark:text-gray-400">Manage your account and application preferences</p>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <!-- Settings Navigation -->
        <div class="lg:col-span-1">
            <app-card>
                <nav class="space-y-1">
                    <button *ngFor="let tab of settingsTabs" (click)="activeTab = tab.id"
                        [class]="getTabClasses(tab.id)">
                        <div [innerHTML]="sanitizeIcon(tab.icon)" class="w-5 h-5"></div>
                        <span class="ml-3">{{ tab.label }}</span>
                    </button>
                </nav>
            </app-card>
        </div>

        <!-- Settings Content -->
        <div class="lg:col-span-2">
            <!-- Profile Settings -->
            <app-card *ngIf="activeTab === 'profile'" title="Profile Settings"
                subtitle="Update your personal information">
                <form [formGroup]="profileForm" (ngSubmit)="saveProfile()" class="space-y-6">
                    <div class="flex items-center space-x-6">
                        <div class="shrink-0">
                            <img [src]="currentUser()?.avatar || 'https://ui-avatars.com/api/?name=John+Doe&background=3b82f6&color=fff'"
                                [alt]="currentUser()?.name" class="h-16 w-16 rounded-full object-cover" />
                        </div>
                        <div class="flex-1">
                            <app-button variant="secondary" size="sm">
                                <svg slot="icon" class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                                </svg>
                                Change Avatar
                            </app-button>
                            <p class="text-sm text-gray-500 dark:text-gray-400 mt-2">JPG, GIF or PNG. 1MB max.</p>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <app-form-field label="First Name" placeholder="Enter first name" formControlName="firstName"
                            [required]="true" [error]="getFieldError(profileForm, 'firstName')" />

                        <app-form-field label="Last Name" placeholder="Enter last name" formControlName="lastName"
                            [required]="true" [error]="getFieldError(profileForm, 'lastName')" />
                    </div>

                    <app-form-field label="Email Address" type="email" placeholder="Enter email address"
                        formControlName="email" [required]="true" [error]="getFieldError(profileForm, 'email')" />

                    <app-form-field label="Job Title" placeholder="Enter job title" formControlName="jobTitle" />

                    <app-form-field label="Bio" type="textarea" placeholder="Tell us about yourself"
                        formControlName="bio" [rows]="4" />

                    <div class="flex justify-end">
                        <app-button type="submit" variant="primary" [loading]="saving">
                            Save Changes
                        </app-button>
                    </div>
                </form>
            </app-card>

            <!-- Security Settings -->
            <app-card *ngIf="activeTab === 'security'" title="Security Settings"
                subtitle="Manage your password and security preferences">
                <div class="space-y-6">
                    <!-- Change Password -->
                    <form [formGroup]="passwordForm" (ngSubmit)="changePassword()" class="space-y-6">
                        <h3 class="text-lg font-medium text-gray-900 dark:text-white">Change Password</h3>

                        <app-form-field label="Current Password" type="password" placeholder="Enter current password"
                            formControlName="currentPassword" [required]="true"
                            [error]="getFieldError(passwordForm, 'currentPassword')" />

                        <app-form-field label="New Password" type="password" placeholder="Enter new password"
                            formControlName="newPassword" [required]="true"
                            [error]="getFieldError(passwordForm, 'newPassword')" />

                        <app-form-field label="Confirm New Password" type="password" placeholder="Confirm new password"
                            formControlName="confirmPassword" [required]="true"
                            [error]="getFieldError(passwordForm, 'confirmPassword')" />

                        <div class="flex justify-end">
                            <app-button type="submit" variant="primary" [loading]="changing"
                                [disabled]="passwordForm.invalid">
                                Update Password
                            </app-button>
                        </div>
                    </form>

                    <div class="border-t border-gray-200 dark:border-gray-700 pt-6">
                        <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Two-Factor Authentication
                        </h3>
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm text-gray-600 dark:text-gray-400">Add an extra layer of security to
                                    your account</p>
                            </div>
                            <app-button variant="secondary" size="sm">
                                Enable 2FA
                            </app-button>
                        </div>
                    </div>

                    <div class="border-t border-gray-200 dark:border-gray-700 pt-6">
                        <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Active Sessions</h3>
                        <div class="space-y-4">
                            <div *ngFor="let session of activeSessions"
                                class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg">
                                <div>
                                    <p class="font-medium text-gray-900 dark:text-white">{{ session.device }}</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">{{ session.location }} â€¢ {{
                                        session.lastActive }}</p>
                                </div>
                                <app-button *ngIf="!session.current" variant="danger" size="sm"
                                    (clicked)="terminateSession(session.id)">
                                    Terminate
                                </app-button>
                                <span *ngIf="session.current"
                                    class="text-sm text-green-600 dark:text-green-400 font-medium">
                                    Current Session
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </app-card>

            <!-- Preferences -->
            <app-card *ngIf="activeTab === 'preferences'" title="Preferences"
                subtitle="Customize your application experience">
                <div class="space-y-6">
                    <!-- Theme -->
                    <div>
                        <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Appearance</h3>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="font-medium text-gray-900 dark:text-white">Dark Mode</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">Use dark theme for better
                                        viewing in low light</p>
                                </div>
                                <button (click)="toggleTheme()" [class]="getToggleClasses(currentTheme() === 'dark')">
                                    <span [class]="getToggleButtonClasses(currentTheme() === 'dark')"></span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Notifications -->
                    <div class="border-t border-gray-200 dark:border-gray-700 pt-6">
                        <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Notifications</h3>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="font-medium text-gray-900 dark:text-white">Email Notifications</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">Receive notifications via email
                                    </p>
                                </div>
                                <button (click)="toggleNotification('email')"
                                    [class]="getToggleClasses(notificationSettings.email)">
                                    <span [class]="getToggleButtonClasses(notificationSettings.email)"></span>
                                </button>
                            </div>

                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="font-medium text-gray-900 dark:text-white">Push Notifications</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">Receive push notifications in
                                        browser</p>
                                </div>
                                <button (click)="toggleNotification('push')"
                                    [class]="getToggleClasses(notificationSettings.push)">
                                    <span [class]="getToggleButtonClasses(notificationSettings.push)"></span>
                                </button>
                            </div>

                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="font-medium text-gray-900 dark:text-white">Weekly Reports</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">Receive weekly analytics reports
                                    </p>
                                </div>
                                <button (click)="toggleNotification('reports')"
                                    [class]="getToggleClasses(notificationSettings.reports)">
                                    <span [class]="getToggleButtonClasses(notificationSettings.reports)"></span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Language & Region -->
                    <div class="border-t border-gray-200 dark:border-gray-700 pt-6">
                        <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Language & Region</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                    Language
                                </label>
                                <select class="input-field">
                                    <option value="en">English</option>
                                    <option value="es">Spanish</option>
                                    <option value="fr">French</option>
                                    <option value="de">German</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                    Timezone
                                </label>
                                <select class="input-field">
                                    <option value="UTC">UTC</option>
                                    <option value="America/New_York">Eastern Time</option>
                                    <option value="America/Chicago">Central Time</option>
                                    <option value="America/Denver">Mountain Time</option>
                                    <option value="America/Los_Angeles">Pacific Time</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </app-card>

            <!-- Danger Zone -->
            <app-card *ngIf="activeTab === 'account'" title="Account Settings" subtitle="Manage your account and data">
                <div class="space-y-6">
                    <div>
                        <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Export Data</h3>
                        <p class="text-sm text-gray-600 dark:text-gray-400 mb-4">
                            Download a copy of your account data in JSON format.
                        </p>
                        <app-button variant="secondary">
                            <svg slot="icon" class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 12l2 2 4-4" />
                            </svg>
                            Export Data
                        </app-button>
                    </div>

                    <div class="border-t border-gray-200 dark:border-gray-700 pt-6">
                        <div
                            class="bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6">
                            <h3 class="text-lg font-medium text-red-800 dark:text-red-400 mb-2">Danger Zone</h3>
                            <p class="text-sm text-red-600 dark:text-red-400 mb-4">
                                Once you delete your account, there is no going back. Please be certain.
                            </p>
                            <app-button variant="danger">
                                Delete Account
                            </app-button>
                        </div>
                    </div>
                </div>
            </app-card>
        </div>
    </div>
</div>